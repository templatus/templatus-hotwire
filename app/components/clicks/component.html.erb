<%= helpers.turbo_stream_from 'clicks' %>

<div data-controller="clicks" data-clicks-count-value="<%= count %>">
  <div class="flex flex-col w-full mt-5 lg:absolute lg:-top-5 lg:-right-10 lg:p-3 lg:mt-0 lg:w-56 lg:bg-linear-to-br lg:from-slate-100 lg:to-white lg:rounded-sm lg:shadow-sm">
    <div class="h-12">
      <div id="counter"
           class="text-5xl font-bold text-center"
           data-clicks-target="counter"
           data-transition-enter="transition-transform duration-200 ease-out"
           data-transition-enter-start="scale-0"
           data-transition-enter-end="scale-100"
           data-transition-leave="transition-transform duration-200 ease-in"
           data-transition-leave-start="scale-100"
           data-transition-leave-end="scale-0"
           data-turbo-permanent="true">
        &nbsp;
      </div>
    </div>

    <div class="py-1 text-center uppercase">Clicks</div>

    <%= button_to 'Click me!',
                  helpers.clicks_path,
                  class: 'mt-3 w-full rounded-sm bg-tertiary py-2 font-medium text-black transition hover:bg-secondary hover:text-white active:outline-hidden active:ring-2 active:ring-secondary active:ring-offset-1' %>

    <p class="hidden mt-3 text-xs text-center text-gray-600 sm:block">
      Tip: Open two browser windows in parallel and see what happens.
    </p>
  </div>

  <h2 class="mt-20 text-xl font-medium tracking-wide text-center uppercase text-primary sm:text-left">
    Latest clicks
  </h2>

  <%= helpers.turbo_frame_tag 'clicks',
                      data: {
                        action: 'turbo:before-stream-render@document->clicks#receive',
                      } do %>
    <ul id="list"
        class="text-sm md:text-base"
        data-clicks-target="list"
        data-transition-enter="transition duration-200 ease-in"
        data-transition-enter-start="translate-y-0"
        data-transition-enter-end="translate-y-32">
      <% clicks.each do |click| %>
        <%= render Click::Component.new(click: click) %>
      <% end %>
    </ul>
  <% end %>
</div>
